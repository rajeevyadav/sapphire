
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Detector simulations &#8212; SAPPHiRE 1.7.1 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/hisparc_style.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simulations based on Monte Carlo EAS ground particle data" href="groundparticles.html" />
    <link rel="prev" title="Simulation base classes" href="base.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="groundparticles.html" title="Simulations based on Monte Carlo EAS ground particle data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="base.html" title="Simulation base classes"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SAPPHiRE 1.7.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../sapphire.html" >SAPPHiRE Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../simulations.html" accesskey="U">Simulation of the detection of EAS events</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-sapphire.simulations.detector">
<span id="detector-simulations"></span><h1>Detector simulations<a class="headerlink" href="#module-sapphire.simulations.detector" title="Permalink to this headline">¶</a></h1>
<p>Common HiSPARC station response simulations</p>
<p>These are some common simulations for HiSPARC detectors.</p>
<dl class="class">
<dt id="sapphire.simulations.detector.HiSPARCSimulation">
<em class="property">class </em><code class="descclassname">sapphire.simulations.detector.</code><code class="descname">HiSPARCSimulation</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.simulate_and_store_offsets">
<code class="descname">simulate_and_store_offsets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.simulate_and_store_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate and store station and detector offsets</p>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.simulate_detector_offsets">
<em class="property">classmethod </em><code class="descname">simulate_detector_offsets</code><span class="sig-paren">(</span><em>n_detectors</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.simulate_detector_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Get multiple detector offsets</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n_detectors</strong> – number of offsets to return.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of detector timing offsets in ns.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.simulate_detector_offset">
<em class="property">classmethod </em><code class="descname">simulate_detector_offset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.simulate_detector_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate time offsets between detectors in one station</p>
<p>This offset should be fixed for each detector for a simulation run.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">detector timing offset in ns.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.simulate_station_offset">
<em class="property">classmethod </em><code class="descname">simulate_station_offset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.simulate_station_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate time offsets between different stations</p>
<p>This offset should be fixed for each station for a simulation run.
The actual distribution is not yet very clear. We assume it is
gaussian for convenience. Then the stddev is about 16 ns.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">station timing offset in ns.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.simulate_gps_uncertainty">
<em class="property">classmethod </em><code class="descname">simulate_gps_uncertainty</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.simulate_gps_uncertainty" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate uncertainty from GPS receiver</p>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.simulate_adc_sampling">
<em class="property">classmethod </em><code class="descname">simulate_adc_sampling</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.simulate_adc_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate ADC time binning due to the sampling frequency</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>t</strong> – time to be binned.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">time ceiled in 2.5 ns base.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.simulate_signal_transport_time">
<em class="property">classmethod </em><code class="descname">simulate_signal_transport_time</code><span class="sig-paren">(</span><em>n=1</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.simulate_signal_transport_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate transport times of scintillation light to the PMT</p>
<p>Generates random transit times within a given distribution and
adds it to the times the particles passed the detector.</p>
<p>Distribution based on Fokkema2012 sec 4.2, figure 4.3</p>
<p>Be careful when editting this function, be sure to check both
the single and vectorized part.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> – number of times to simulate</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of signal transport times</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.simulate_detector_mips">
<em class="property">classmethod </em><code class="descname">simulate_detector_mips</code><span class="sig-paren">(</span><em>n</em>, <em>theta</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.simulate_detector_mips" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate the detector signal for particles</p>
<p>Simulation of convoluted distribution of electron and
muon energy losses with the scintillator response</p>
<p>The detector response (energy loss and detector efficiency) is derived
in Montanus2014.</p>
<p>The energy loss is taken from the Bethe-Bloch equation. The detector
response is statistically modelled. The effect of particle angle of
incidence is accounted for. The resulting probability
distribution is used below.</p>
<p>The statistics can be simulated by taking a random number y between
0 and 1, and convert it to a signal s in MIP using the probablity
distribution.</p>
<dl class="docutils">
<dt>Montanus2014: J.C.M. Montanus, The Landau distribution,</dt>
<dd>Internal note (Nikhef), 22 may 2014</dd>
</dl>
<p>Be careful when editting this function, be sure to check both
the single and vectorized part.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> – number of particles.</li>
<li><strong>theta</strong> – angle of incidence of the particles. Either a single
value valid for all particles, or an array with an angle
for each particle.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">signal strength in number of mips.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.generate_core_position">
<em class="property">classmethod </em><code class="descname">generate_core_position</code><span class="sig-paren">(</span><em>r_max</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.generate_core_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random core position within a circle</p>
<p>DF: This is the fastest implementation I could come up with.  I
timed several permutations of numpy / math, and tried a Monte
Carlo method in which I pick x and y in a square (fast) and then
determine if they fall inside a circle or not (surprisingly
slow, because of an if-statement, and despite some optimizations
suggested by HM).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>r</strong> – Maximum core distance, in meters.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Random x, y position in the disc with radius r_max.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.generate_zenith">
<em class="property">classmethod </em><code class="descname">generate_zenith</code><span class="sig-paren">(</span><em>min=0</em>, <em>max=1.0471975511965976</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.generate_zenith" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random zenith</p>
<p>Generate a random zenith for a uniform distribution on a sphere.
For a random position on a sphere the zenith should not be chosen
from a uniform [0, pi/2] distribution.</p>
<p>Source: <a class="reference external" href="http://mathworld.wolfram.com/SpherePointPicking.html">http://mathworld.wolfram.com/SpherePointPicking.html</a></p>
<p>This fuction does not account for attenuation due to the extra path
length, nor for the reduced effective surface of the detectors due to
the angle. CORSIKA simulated showers already contain the atmospheric
attenuation and precise positions for each particle.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>min</strong><strong>,</strong><strong>max</strong> – minimum and maximum zenith angles, in radians.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">random zenith position on a sphere, in radians.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.generate_attenuated_zenith">
<em class="property">classmethod </em><code class="descname">generate_attenuated_zenith</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.generate_attenuated_zenith" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random zenith</p>
<p>Pick from the expected zenith distribution.</p>
<p>There is a difference between expected shower zeniths detected on the
ground and at the top of the atmosphere. This distribution takes the
attenuation of air showers due to the extra path length in the
atmosphere into account.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">random zenith angle, in radians.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.inverse_zenith_probability">
<em class="property">classmethod </em><code class="descname">inverse_zenith_probability</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.inverse_zenith_probability" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse cumulative probability distribution for zenith</p>
<p>Derrived from Schultheiss “The acceptancy of the HiSPARC Network”,
(internal note), eq 2.4 from Rossi.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>p</strong> – probability value between 0 and 1.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">zenith with corresponding cumulative probability, in radians.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.generate_azimuth">
<em class="property">classmethod </em><code class="descname">generate_azimuth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.generate_azimuth" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random azimuth</p>
<p>Showers from each azimuth have equal probability</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">shower azimuth angle, in radians.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.HiSPARCSimulation.generate_energy">
<em class="property">classmethod </em><code class="descname">generate_energy</code><span class="sig-paren">(</span><em>e_min=100000000000000.0</em>, <em>e_max=1e+21</em>, <em>alpha=-2.75</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.HiSPARCSimulation.generate_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random shower energy</p>
<p>Source: <a class="reference external" href="http://mathworld.wolfram.com/RandomNumber.html">http://mathworld.wolfram.com/RandomNumber.html</a></p>
<p>Simple approximation of the cosmic-ray energy spectrum. Showers
with higher energy occur less often, following a power law.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>e_min</strong><strong>,</strong><strong>e_max</strong> – Energy bounds for the distribution (in eV).</li>
<li><strong>alpha</strong> – Steepness of the power law distribution.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">primary particle energy, in eV.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sapphire.simulations.detector.ErrorlessSimulation">
<em class="property">class </em><code class="descclassname">sapphire.simulations.detector.</code><code class="descname">ErrorlessSimulation</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.ErrorlessSimulation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="classmethod">
<dt id="sapphire.simulations.detector.ErrorlessSimulation.simulate_detector_offsets">
<em class="property">classmethod </em><code class="descname">simulate_detector_offsets</code><span class="sig-paren">(</span><em>n_detectors</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.ErrorlessSimulation.simulate_detector_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Get multiple detector offsets</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n_detectors</strong> – number of offsets to return.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of detector timing offsets in ns.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.ErrorlessSimulation.simulate_detector_offset">
<em class="property">classmethod </em><code class="descname">simulate_detector_offset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.ErrorlessSimulation.simulate_detector_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate time offsets between detectors in one station</p>
<p>This offset should be fixed for each detector for a simulation run.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">detector timing offset in ns.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.ErrorlessSimulation.simulate_station_offset">
<em class="property">classmethod </em><code class="descname">simulate_station_offset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.ErrorlessSimulation.simulate_station_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate time offsets between different stations</p>
<p>This offset should be fixed for each station for a simulation run.
The actual distribution is not yet very clear. We assume it is
gaussian for convenience. Then the stddev is about 16 ns.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">station timing offset in ns.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.ErrorlessSimulation.simulate_gps_uncertainty">
<em class="property">classmethod </em><code class="descname">simulate_gps_uncertainty</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.ErrorlessSimulation.simulate_gps_uncertainty" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate uncertainty from GPS receiver</p>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.ErrorlessSimulation.simulate_adc_sampling">
<em class="property">classmethod </em><code class="descname">simulate_adc_sampling</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.ErrorlessSimulation.simulate_adc_sampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate ADC time binning due to the sampling frequency</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>t</strong> – time to be binned.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">time ceiled in 2.5 ns base.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.ErrorlessSimulation.simulate_signal_transport_time">
<em class="property">classmethod </em><code class="descname">simulate_signal_transport_time</code><span class="sig-paren">(</span><em>n=1</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.ErrorlessSimulation.simulate_signal_transport_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate transport times of scintillation light to the PMT</p>
<p>Generates random transit times within a given distribution and
adds it to the times the particles passed the detector.</p>
<p>Distribution based on Fokkema2012 sec 4.2, figure 4.3</p>
<p>Be careful when editting this function, be sure to check both
the single and vectorized part.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> – number of times to simulate</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of signal transport times</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="sapphire.simulations.detector.ErrorlessSimulation.simulate_detector_mips">
<em class="property">classmethod </em><code class="descname">simulate_detector_mips</code><span class="sig-paren">(</span><em>n</em>, <em>theta</em><span class="sig-paren">)</span><a class="headerlink" href="#sapphire.simulations.detector.ErrorlessSimulation.simulate_detector_mips" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate the detector signal for particles</p>
<p>Simulation of convoluted distribution of electron and
muon energy losses with the scintillator response</p>
<p>The detector response (energy loss and detector efficiency) is derived
in Montanus2014.</p>
<p>The energy loss is taken from the Bethe-Bloch equation. The detector
response is statistically modelled. The effect of particle angle of
incidence is accounted for. The resulting probability
distribution is used below.</p>
<p>The statistics can be simulated by taking a random number y between
0 and 1, and convert it to a signal s in MIP using the probablity
distribution.</p>
<dl class="docutils">
<dt>Montanus2014: J.C.M. Montanus, The Landau distribution,</dt>
<dd>Internal note (Nikhef), 22 may 2014</dd>
</dl>
<p>Be careful when editting this function, be sure to check both
the single and vectorized part.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> – number of particles.</li>
<li><strong>theta</strong> – angle of incidence of the particles. Either a single
value valid for all particles, or an array with an angle
for each particle.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">signal strength in number of mips.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/header.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="base.html"
                        title="previous chapter">Simulation base classes</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="groundparticles.html"
                        title="next chapter">Simulations based on Monte Carlo EAS ground particle data</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="groundparticles.html" title="Simulations based on Monte Carlo EAS ground particle data"
             >next</a> |</li>
        <li class="right" >
          <a href="base.html" title="Simulation base classes"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">SAPPHiRE 1.7.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../sapphire.html" >SAPPHiRE Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../simulations.html" >Simulation of the detection of EAS events</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2018, David Fokkema, Arne de Laat, and Tom Kooij.
    </div>
  </body>
</html>